<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Entra√Ænement garde debout v2.0</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;--primary:#3b82f6;--primary-hover:#2563eb;--success:#10b981;--danger:#ef4444;--warning:#f59e0b}
    *{box-sizing:border-box}
    body{display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);color:#e6eef8;padding:20px}
    .card{width:min(900px,100%);background:linear-gradient(180deg,#1e293b,#0f172a);padding:30px;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.05)}
    h1{margin:0 0 8px;font-size:28px;background:linear-gradient(90deg,#60a5fa,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    p{margin:4px 0 20px;color:#94a3b8;font-size:15px}
    .main-content{display:grid;grid-template-columns:1fr 1fr;gap:30px}
    @media(max-width:768px){.main-content{grid-template-columns:1fr}.card{padding:20px}}
    .result-section{background:rgba(59,130,246,.05);padding:24px;border-radius:12px;border:1px solid rgba(59,130,246,.2)}
    .status-display{text-align:center;margin:20px 0}
    .status-icon{font-size:80px;margin:20px 0;animation:float 3s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
    .status-text{font-size:24px;font-weight:600;color:#60a5fa;margin:12px 0}
    .elapsed-time{font-size:18px;color:#94a3b8;font-family:monospace;letter-spacing:2px}
    .controls{display:flex;flex-direction:column;gap:12px;margin-top:16px}
    button{padding:14px 24px;border-radius:10px;border:0;cursor:pointer;font-weight:600;font-size:16px;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:8px;width:100%}
    button:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.3)}
    button:active{transform:translateY(0)}
    button:disabled{opacity:.5;cursor:not-allowed;transform:none}
    .btn-primary{background:var(--primary);color:white}
    .btn-primary:hover:not(:disabled){background:var(--primary-hover)}
    .btn-danger{background:var(--danger);color:white}
    .btn-success{background:var(--success);color:white}
    .btn-warning{background:var(--warning);color:white}
    .btn-secondary{background:rgba(100,116,139,.2);color:#e2e8f0;border:1px solid rgba(255,255,255,.1)}
    .btn-night{background:#7c3aed;color:white}
    .settings{background:rgba(15,23,42,.5);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,.05);margin-top:20px}
    .setting-group{margin-bottom:16px}
    .setting-group:last-child{margin-bottom:0}
    label{display:block;margin-bottom:6px;color:#cbd5e1;font-size:14px;font-weight:500}
    .checkbox-label{display:flex;align-items:center;gap:10px;cursor:pointer;padding:8px;border-radius:8px;transition:background .2s}
    input[type=checkbox]{width:18px;height:18px;cursor:pointer;accent-color:var(--primary)}
    input[type=text]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(15,23,42,.6);color:#e2e8f0;font-size:14px}
    textarea{width:100%;height:120px;border-radius:8px;padding:12px;margin-top:8px;border:1px solid rgba(255,255,255,.1);background:rgba(15,23,42,.6);color:#e2e8f0;font-family:monospace;font-size:13px;resize:vertical}
    .instructions{background:rgba(15,23,42,.3);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,.05);margin-bottom:16px}
    .instructions h3{margin:0 0 12px;color:#60a5fa;font-size:18px}
    .instructions ul{margin:0;padding-left:20px;line-height:1.8;color:#94a3b8}
    .instructions li{margin-bottom:8px}
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
    .stat-card{background:rgba(15,23,42,.4);padding:12px;border-radius:8px;text-align:center;border:1px solid rgba(255,255,255,.05)}
    .stat-value{font-size:24px;font-weight:700;color:#60a5fa}
    .stat-label{font-size:12px;color:#94a3b8;margin-top:4px}
    .toast{position:fixed;top:20px;right:20px;background:#10b981;color:white;padding:12px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.3);opacity:0;transform:translateY(-20px);transition:all .3s ease;z-index:1000}
    .toast.show{opacity:1;transform:translateY(0)}
    .questionnaire{display:none;animation:fadeIn .3s ease}
    .questionnaire.active{display:block}
    .questionnaire h3{margin:0 0 16px;color:#60a5fa;font-size:18px;text-align:center}
    .questionnaire-buttons{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
    .phase-indicator{text-align:center;padding:12px;background:rgba(59,130,246,.1);border-radius:8px;margin-bottom:16px;border:1px solid rgba(59,130,246,.2)}
    .phase-indicator.active{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.3)}
    .phase-indicator.waiting{background:rgba(245,158,11,.1);border-color:rgba(245,158,11,.3);animation:pulse-waiting 2s infinite}
    @keyframes pulse-waiting{0%,100%{opacity:1}50%{opacity:.7}}
    .alert-flash{position:fixed;top:0;left:0;right:0;bottom:0;background:#ef4444;z-index:9999;display:none;animation:flash .5s ease-in-out infinite}
    .alert-flash.active{display:block}
    @keyframes flash{0%,100%{opacity:0}50%{opacity:.9}}
    .alert-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;color:#000;padding:40px;border-radius:20px;font-size:32px;font-weight:bold;text-align:center;z-index:10000;display:none;box-shadow:0 10px 40px rgba(0,0,0,.5)}
    .alert-message.active{display:block;animation:bounce .5s ease-in-out infinite}
    @keyframes bounce{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.1)}}
    .level-badge{display:inline-block;padding:4px 12px;border-radius:6px;font-size:12px;font-weight:600;background:rgba(59,130,246,.2);color:#60a5fa;margin-left:8px}
    .session-info{background:rgba(124,58,237,.1);border:1px solid rgba(124,58,237,.3);padding:12px;border-radius:8px;margin-bottom:12px;font-size:13px;color:#c4b5fd;display:none}
    .session-info strong{color:#a78bfa}
  </style>
</head>
<body>
  <div class="alert-flash" id="alertFlash"></div>
  <div class="alert-message" id="alertMessage">üîî TEMPS √âCOUL√â ! üîî<br><span style="font-size:24px">Appuyez pour arr√™ter</span></div>
  <audio id="beepAudio" preload="auto"><source src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" type="audio/mpeg"></audio>
  
  <main class="card">
    <h1>üö™ Entra√Ænement garde debout</h1>
    <p>Syst√®me d'entra√Ænement progressif avec √©chauffement et √©tirements</p>

    <div class="main-content">
      <div>
        <div class="result-section">
          <div class="phase-indicator" id="phaseIndicator"><strong>S√©lectionnez votre niveau</strong></div>
          <div id="sessionInfo" class="session-info"><strong>Session :</strong> <span id="sessionType"></span><br><strong>Dur√©e :</strong> <span id="sessionDuration"></span></div>
          
          <div class="status-display">
            <div class="status-icon" id="statusIcon">‚è±Ô∏è</div>
            <div class="status-text" id="statusText">En attente</div>
            <div class="elapsed-time" id="elapsedTime"></div>
          </div>
          
          <div class="controls" id="levelSelection">
            <label style="text-align:center;margin-bottom:8px">Choisissez votre niveau</label>
            <button id="level1" class="btn-primary">Niveau 1 <span class="level-badge">2-5h</span></button>
            <button id="level2" class="btn-primary">Niveau 2 <span class="level-badge">4-7h</span></button>
            <button id="level3" class="btn-primary">Niveau 3 <span class="level-badge">7-9h</span></button>
            <button id="level4" class="btn-primary">Niveau 4 <span class="level-badge">9h fixe</span></button>
            <button id="level5" class="btn-primary">Niveau 5 <span class="level-badge">2-9h</span></button>
          </div>

          <div class="controls" id="warmupSelection" style="display:none">
            <button id="startWithWarmup" class="btn-warning">üî• Commencer avec √©chauffement (20-45 min)</button>
            <button id="startWithoutWarmup" class="btn-primary">‚ñ∂Ô∏è Commencer directement</button>
          </div>

          <div class="controls" id="runningControls" style="display:none">
            <button id="stop" class="btn-danger">üõë Arr√™ter</button>
          </div>

          <div class="questionnaire" id="questionnaire">
            <h3>üí¨ Comment s'est pass√© l'entra√Ænement ?</h3>
            <div class="questionnaire-buttons">
              <button class="btn-success" id="btnSuccess">‚úÖ Tenu jusqu'au bout</button>
              <button class="btn-danger" id="btnFailed">‚ùå Abandonn√© avant</button>
              <button class="btn-warning" id="btnPartial">‚ö†Ô∏è Tenu partiellement</button>
              <button class="btn-secondary" id="btnSkip">‚è≠Ô∏è Ne pas partager</button>
            </div>
          </div>

          <div class="controls" id="stretchingOption" style="display:none">
            <button id="startStretching" class="btn-warning">üßò Faire les √©tirements (20-45 min)</button>
            <button id="skipStretching" class="btn-secondary">‚è≠Ô∏è Passer</button>
          </div>

          <div class="controls" id="nightTrainingOption" style="display:none">
            <button id="startNightTraining" class="btn-night">üåô 2e entra√Ænement nocturne (1-3h)</button>
          </div>
        </div>

        <div class="stats">
          <div class="stat-card"><div class="stat-value" id="statTotal">0</div><div class="stat-label">Sessions</div></div>
          <div class="stat-card"><div class="stat-value" id="statLast">‚Äî</div><div class="stat-label">Derni√®re</div></div>
          <div class="stat-card"><div class="stat-value" id="statSuccess">0%</div><div class="stat-label">R√©ussite</div></div>
        </div>

        <div class="settings">
          <div class="setting-group">
            <label>Num√©ro destinataire (sans +)</label>
            <input type="text" id="phone" value="33783204184" placeholder="337..."/>
          </div>
          <div class="setting-group">
            <label class="checkbox-label"><input type="checkbox" id="includeDate" checked/><span>Inclure date/heure</span></label>
            <label class="checkbox-label"><input type="checkbox" id="soundAlert" checked/><span>Signal sonore</span></label>
          </div>
          <div class="setting-group">
            <label>Aper√ßu du message</label>
            <textarea id="message" readonly></textarea>
          </div>
        </div>
      </div>

      <div>
        <div class="instructions">
          <h3>‚ö†Ô∏è Avant de commencer</h3>
          <ul>
            <li><strong>üîå Branchez</strong> votre t√©l√©phone</li>
            <li><strong>üîä Testez</strong> avec le bouton ci-dessous</li>
            <li><strong>üîî Triple alerte :</strong> Son + Vibration + Flash rouge</li>
          </ul>
          <button id="testSound" class="btn-warning">üîä Tester TOUT</button>
        </div>

        <div class="instructions">
          <h3>üìä Niveaux</h3>
          <ul>
            <li><strong>Niveau 1 :</strong> 2-5h (d√©butant)</li>
            <li><strong>Niveau 2 :</strong> 4-7h (interm√©diaire)</li>
            <li><strong>Niveau 3 :</strong> 7-9h (avanc√©)</li>
            <li><strong>Niveau 4 :</strong> 9h fixe (expert)</li>
            <li><strong>Niveau 5 :</strong> 2-9h (al√©atoire)</li>
          </ul>
        </div>

        <div class="instructions">
          <h3>üî• Options</h3>
          <ul>
            <li><strong>√âchauffement :</strong> 20-45 min</li>
            <li><strong>√âtirements :</strong> 20-45 min</li>
            <li><strong>Nocturne :</strong> 1-3h (si √©ligible)</li>
          </ul>
        </div>
      </div>
    </div>
  </main>

  <div id="toast" class="toast"></div>

<script>
let stats={total:0,successes:0,durations:[],lastTrainingDuration:0};
let targetDuration=0,startTime=0,timerInterval=null,audioContext=null,wakeLock=null,audioBuffer=null,selectedLevel=0,currentPhase='idle',trainingPhase='main';

const beepAudio=document.getElementById('beepAudio');
const elements={
  statusIcon:document.getElementById('statusIcon'),
  statusText:document.getElementById('statusText'),
  elapsedTime:document.getElementById('elapsedTime'),
  msgEl:document.getElementById('message'),
  stopBtn:document.getElementById('stop'),
  levelSelection:document.getElementById('levelSelection'),
  warmupSelection:document.getElementById('warmupSelection'),
  runningControls:document.getElementById('runningControls'),
  questionnaire:document.getElementById('questionnaire'),
  stretchingOption:document.getElementById('stretchingOption'),
  nightTrainingOption:document.getElementById('nightTrainingOption'),
  phaseIndicator:document.getElementById('phaseIndicator'),
  soundAlert:document.getElementById('soundAlert'),
  includeDate:document.getElementById('includeDate'),
  phoneInput:document.getElementById('phone'),
  statTotal:document.getElementById('statTotal'),
  statLast:document.getElementById('statLast'),
  statSuccess:document.getElementById('statSuccess'),
  sessionInfo:document.getElementById('sessionInfo'),
  sessionType:document.getElementById('sessionType'),
  sessionDuration:document.getElementById('sessionDuration'),
  alertFlash:document.getElementById('alertFlash'),
  alertMessage:document.getElementById('alertMessage')
};

function randomDuration(minH,maxH){return Math.floor(Math.random()*(maxH*3600000-minH*3600000+1))+minH*3600000}
function generateWarmupDuration(){const r=Math.random()*100;return r<60?randomDuration(40/60,45/60):r<90?randomDuration(30/60,40/60):randomDuration(20/60,30/60)}
function formatDuration(ms){const h=Math.floor(ms/3600000),m=Math.floor(ms%3600000/60000),s=Math.floor(ms%60000/1000);return `${h}h ${m.toString().padStart(2,'0')}m ${s.toString().padStart(2,'0')}s`}
function formatDurationShort(ms){const h=Math.floor(ms/3600000),m=Math.floor(ms%3600000/60000);return h>0&&m>0?`${h}h${m}m`:h>0?`${h}h`:`${m}m`}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000)}

function playBeep(){
  if(!elements.soundAlert.checked)return;
  beepAudio.currentTime=0;
  beepAudio.play().then(()=>{
    let cnt=1;
    const iv=setInterval(()=>{
      if(cnt<5){beepAudio.currentTime=0;beepAudio.play();cnt++}else{clearInterval(iv)}
    },2000);
  }).catch(e=>console.error('Audio error:',e));
}

function vibrate(){
  if('vibrate' in navigator){
    const pat=[200,100,200,100,200,300,200,100,200,100,200];
    for(let i=0;i<5;i++)setTimeout(()=>navigator.vibrate(pat),i*2000);
  }
}

function showVisualAlert(){
  elements.alertFlash.classList.add('active');
  elements.alertMessage.classList.add('active');
  elements.alertMessage.addEventListener('click',stopVisualAlert);
  elements.alertFlash.addEventListener('click',stopVisualAlert);
}

function stopVisualAlert(){
  elements.alertFlash.classList.remove('active');
  elements.alertMessage.classList.remove('active');
}

function testSound(){
  showToast('üîä Test : Son + Vibration + Flash');
  playBeep();vibrate();showVisualAlert();
}

async function requestWakeLock(){
  try{
    if('wakeLock' in navigator){
      wakeLock=await navigator.wakeLock.request('screen');
      wakeLock.addEventListener('release',()=>console.log('Wake Lock released'));
    }
  }catch(e){console.error('Wake Lock error:',e)}
}

function releaseWakeLock(){
  if(wakeLock){wakeLock.release();wakeLock=null}
}

function selectLevel(lvl){
  selectedLevel=lvl;
  elements.levelSelection.style.display='none';
  elements.warmupSelection.style.display='flex';
  elements.phaseIndicator.innerHTML=`<strong>Niveau ${lvl} s√©lectionn√©</strong> ‚Äî √âchauffement ?`;
  showToast(`‚úÖ Niveau ${lvl} s√©lectionn√©`);
}

function getLevelDuration(lvl){
  switch(lvl){
    case 1:return randomDuration(2,5);
    case 2:return randomDuration(4,7);
    case 3:return randomDuration(7,9);
    case 4:return 9*3600000;
    case 5:return randomDuration(2,9);
    default:return randomDuration(2,9);
  }
}

async function startTraining(withWarmup){
  beepAudio.play().then(()=>{beepAudio.pause();beepAudio.currentTime=0}).catch(e=>console.log('init:',e));
  await requestWakeLock();
  
  if(withWarmup){
    trainingPhase='warmup';
    targetDuration=generateWarmupDuration();
    elements.sessionType.textContent='√âchauffement';
    elements.statusIcon.textContent='üî•';
    elements.statusText.textContent='√âchauffement...';
    elements.phaseIndicator.innerHTML='<strong>√âchauffement</strong>';
  }else{
    trainingPhase='main';
    targetDuration=getLevelDuration(selectedLevel);
    elements.sessionType.textContent=`Entra√Ænement Niveau ${selectedLevel}`;
    elements.statusIcon.textContent='üö™';
    elements.statusText.textContent='En garde...';
    elements.phaseIndicator.innerHTML='<strong>Entra√Ænement</strong>';
  }
  
  elements.sessionDuration.textContent='??:??';
  elements.sessionInfo.style.display='block';
  startTime=Date.now();
  elements.warmupSelection.style.display='none';
  elements.runningControls.style.display='flex';
  elements.phaseIndicator.classList.add('waiting');
  
  timerInterval=setInterval(()=>{
    elements.elapsedTime.textContent=formatDuration(Date.now()-startTime);
    if(Date.now()-startTime>=targetDuration)endTraining();
  },1000);
  
  showToast('üöÄ D√©marr√© !');
}

function endTraining(){
  clearInterval(timerInterval);
  releaseWakeLock();
  playBeep();vibrate();showVisualAlert();
  
  if(trainingPhase==='warmup'){
    elements.statusText.textContent='√âchauffement termin√© !';
    elements.phaseIndicator.classList.remove('waiting');
    elements.runningControls.style.display='none';
    elements.sessionInfo.style.display='none';
    setTimeout(()=>{stopVisualAlert();startTraining(false)},3000);
  }else if(trainingPhase==='main'){
    elements.statusText.textContent='Termin√© !';
    elements.phaseIndicator.classList.remove('waiting');
    elements.phaseIndicator.classList.add('active');
    elements.runningControls.style.display='none';
    elements.questionnaire.classList.add('active');
  }else if(trainingPhase==='stretching'){
    elements.statusText.textContent='√âtirements termin√©s !';
    elements.runningControls.style.display='none';
    elements.sessionInfo.style.display='none';
    setTimeout(()=>{stopVisualAlert();checkNightTraining();resetToInitial()},3000);
  }else if(trainingPhase==='night'){
    elements.statusText.textContent='Nocturne termin√© !';
    elements.runningControls.style.display='none';
    elements.questionnaire.classList.add('active');
  }
}

function stopTraining(){
  if(confirm('Arr√™ter ?')){
    clearInterval(timerInterval);
    releaseWakeLock();
    elements.runningControls.style.display='none';
    elements.sessionInfo.style.display='none';
    setTimeout(resetToInitial,2000);
  }
}

function resetToInitial(){
  stopVisualAlert();
  elements.levelSelection.style.display='flex';
  elements.warmupSelection.style.display='none';
  elements.runningControls.style.display='none';
  elements.questionnaire.classList.remove('active');
  elements.stretchingOption.style.display='none';
  elements.nightTrainingOption.style.display='none';
  elements.sessionInfo.style.display='none';
  elements.phaseIndicator.classList.remove('active','waiting');
  elements.phaseIndicator.innerHTML='<strong>S√©lectionnez votre niveau</strong>';
  elements.statusIcon.textContent='‚è±Ô∏è';
  elements.statusText.textContent='En attente';
  elements.elapsedTime.textContent='';
  selectedLevel=0;trainingPhase='main';
}

function updateStats(dur,success){
  stats.total++;
  if(success)stats.successes++;
  stats.durations.push(dur);
  stats.lastTrainingDuration=dur;
  elements.statTotal.textContent=stats.total;
  elements.statLast.textContent=formatDurationShort(dur);
  elements.statSuccess.textContent=Math.round(stats.successes/stats.total*100)+'%';
}

function buildMessage(dur,result,phase){
  let msg=`üö™ Entra√Ænement garde debout\nType : ${phase}\nDur√©e : ${formatDuration(dur)}\nR√©sultat : ${result}\n`;
  if(elements.includeDate.checked){
    const d=new Date().toLocaleString('fr-FR',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'});
    msg+=`üìÖ ${d}\n`;
  }
  return msg+'\n(Guard-Trainer v2.0)';
}

function handleResult(emoji,text,success){
  const phase=trainingPhase==='night'?'Entra√Ænement nocturne':'Entra√Ænement principal';
  const msg=buildMessage(targetDuration,emoji+' '+text,phase);
  elements.msgEl.value=msg;
  updateStats(targetDuration,success);
  
  const phone=elements.phoneInput.value.trim();
  if(!phone){showToast('‚ö†Ô∏è Num√©ro manquant');return}
  
  showToast('üì± WhatsApp...');
  setTimeout(()=>{
    window.open(`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`,'_blank');
    if(trainingPhase==='main'){
      elements.questionnaire.classList.remove('active');
      elements.stretchingOption.style.display='flex';
    }else{
      checkNightTraining();resetToInitial();
    }
  },500);
}

function checkNightTraining(){
  const durH=stats.lastTrainingDuration/3600000;
  if(durH>=2&&durH<=4){
    elements.nightTrainingOption.style.display='flex';
    showToast('üåô Nocturne disponible');
  }
}

async function startStretching(){
  trainingPhase='stretching';
  targetDuration=generateWarmupDuration();
  await requestWakeLock();
  elements.stretchingOption.style.display='none';
  elements.runningControls.style.display='flex';
  elements.sessionType.textContent='√âtirements';
  elements.sessionDuration.textContent='??:??';
  elements.sessionInfo.style.display='block';
  elements.statusIcon.textContent='üßò';
  elements.statusText.textContent='√âtirements...';
  elements.phaseIndicator.innerHTML='<strong>√âtirements</strong>';
  elements.phaseIndicator.classList.add('waiting');
  startTime=Date.now();
  timerInterval=setInterval(()=>{
    elements.elapsedTime.textContent=formatDuration(Date.now()-startTime);
    if(Date.now()-startTime>=targetDuration)endTraining();
  },1000);
}

async function startNightTraining(){
  trainingPhase='night';
  targetDuration=randomDuration(1,3);
  await requestWakeLock();
  elements.nightTrainingOption.style.display='none';
  elements.runningControls.style.display='flex';
  elements.sessionType.textContent='Entra√Ænement nocturne';
  elements.sessionDuration.textContent='??:??';
  elements.sessionInfo.style.display='block';
  elements.statusIcon.textContent='üåô';
  elements.statusText.textContent='Nocturne...';
  elements.phaseIndicator.innerHTML='<strong>Entra√Ænement nocturne</strong>';
  elements.phaseIndicator.classList.add('waiting');
  startTime=Date.now();
  timerInterval=setInterval(()=>{
    elements.elapsedTime.textContent=formatDuration(Date.now()-startTime);
    if(Date.now()-startTime>=targetDuration)endTraining();
  },1000);
}

document.getElementById('level1').addEventListener('click',()=>selectLevel(1));
document.getElementById('level2').addEventListener('click',()=>selectLevel(2));
document.getElementById('level3').addEventListener('click',()=>selectLevel(3));
document.getElementById('level4').addEventListener('click',()=>selectLevel(4));
document.getElementById('level5').addEventListener('click',()=>selectLevel(5));
document.getElementById('startWithWarmup').addEventListener('click',()=>startTraining(true));
document.getElementById('startWithoutWarmup').addEventListener('click',()=>startTraining(false));
document.getElementById('stop').addEventListener('click',stopTraining);
document.getElementById('testSound').addEventListener('click',testSound);
document.getElementById('btnSuccess').addEventListener('click',()=>handleResult('‚úÖ','Tenu jusqu\'au bout',true));
document.getElementById('btnFailed').addEventListener('click',()=>handleResult('‚ùå','Abandonn√©',false));
document.getElementById('btnPartial').addEventListener('click',()=>handleResult('‚ö†Ô∏è','Partiel',false));
document.getElementById('btnSkip').addEventListener('click',()=>{
  showToast('‚è≠Ô∏è Non partag√©');
  if(trainingPhase==='main'){
    elements.questionnaire.classList.remove('active');
    elements.stretchingOption.style.display='flex';
  }else{
    checkNightTraining();resetToInitial();
  }
});
document.getElementById('startStretching').addEventListener('click',startStretching);
document.getElementById('skipStretching').addEventListener('click',()=>{
  elements.stretchingOption.style.display='none';
  checkNightTraining();resetToInitial();
});
document.getElementById('startNightTraining').addEventListener('click',startNightTraining);
document.addEventListener('visibilitychange',async()=>{
  if(wakeLock!==null&&document.visibilityState==='visible')await requestWakeLock();
});
</script>
</body>
</html>
